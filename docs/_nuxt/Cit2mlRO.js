import{u as l}from"./DT4xflgl.js";import{O as r,a8 as p,v as d,e as f,ah as g,ag as c,ai as w}from"./8FcX_UG7.js";const m="$s";function v(...i){const s=typeof i[i.length-1]=="string"?i.pop():void 0;typeof i[0]!="string"&&i.unshift(s);const[a,e]=i;if(!a||typeof a!="string")throw new TypeError("[nuxt] [useState] key must be a string: "+a);if(e!==void 0&&typeof e!="function")throw new Error("[nuxt] [useState] init must be a function: "+e);const u=m+a,n=r(),t=p(n.payload.state,u);if(t.value===void 0&&e){const o=e();if(d(o))return n.payload.state[u]=o,o;t.value=o}return t}const S=()=>v("shareData",()=>{}),y=f({__name:"default",setup(i){const s=e=>{wx.config({debug:!1,appId:e.value.signPackage.appId,timestamp:e.value.signPackage.timestamp,nonceStr:e.value.signPackage.nonceStr,signature:e.value.signPackage.signature,jsApiList:["updateAppMessageShareData","updateTimelineShareData","onMenuShareTimeline","onMenuShareAppMessage"]}),wx.ready(function(){wx.updateAppMessageShareData({title:e.value.title,desc:e.value.desc,link:window.location.href,imgUrl:e.value.imgUrl,success:function(){}}),wx.updateTimelineShareData({title:e.value.title,link:window.location.href,imgUrl:e.value.imgUrl,desc:e.value.desc,success:function(){}}),wx.onMenuShareTimeline({title:e.value.title,desc:e.value.desc,link:window.location.href,imgUrl:e.value.imgUrl,success:function(){}}),wx.onMenuShareAppMessage({title:e.value.title,link:window.location.href,imgUrl:e.value.imgUrl,desc:e.value.desc,success:function(){}})})};return(async()=>{const e=c("key");if(!c("openid").value||!e.value){const n=await l("/wxh5/Index/jsLogin",{params:{callbackurl:encodeURIComponent(window.location.href)}});let t=w(n.data.value),{data:o}=JSON.parse(t);window.location.href=o.url;return}else{const n=S();if(n.value)s(n);else{let t=await l("/wxh5/Index/getJsSignPackage",{params:{url:encodeURIComponent(window.location.href)}});t.data&&(n.value=t.data,s(n))}}})(),(e,u)=>g(e.$slots,"default")}});export{y as default};
